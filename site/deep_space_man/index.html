
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../trips_to_jupiter/">
      
      
        <link rel="next" href="../low_thrust_trajectories/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.11">
    
    
      
        <title>Trajectories with Deep-Space Manoeuvres - ASTRA</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.4af4bdda.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="light-blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#method-overview" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="ASTRA" class="md-header__button md-logo" aria-label="ASTRA" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ASTRA
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Trajectories with Deep-Space Manoeuvres
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/andreabellome/astra" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    ASTRA repository
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="ASTRA" class="md-nav__button md-logo" aria-label="ASTRA" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    ASTRA
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/andreabellome/astra" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    ASTRA repository
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../install/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Tutorials
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../trips_to_jupiter/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Trips to Jupiter
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Trajectories with Deep-Space Manoeuvres
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Trajectories with Deep-Space Manoeuvres
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#method-overview" class="md-nav__link">
    <span class="md-ellipsis">
      Method Overview
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Method Overview">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-one-dsm" class="md-nav__link">
    <span class="md-ellipsis">
      Using One DSM
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-multiple-dsms" class="md-nav__link">
    <span class="md-ellipsis">
      Using Multiple DSMs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mission-to-saturn" class="md-nav__link">
    <span class="md-ellipsis">
      Mission to Saturn
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Mission to Saturn">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#set-up" class="md-nav__link">
    <span class="md-ellipsis">
      Set-up
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bounds-and-constraints" class="md-nav__link">
    <span class="md-ellipsis">
      Bounds and constraints
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#optimisation" class="md-nav__link">
    <span class="md-ellipsis">
      Optimisation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../low_thrust_trajectories/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Low-thrust trajectories
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../nasa_ephemerides/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Using NASA ephemerides
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../custom_input/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Using custom input parameters
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#method-overview" class="md-nav__link">
    <span class="md-ellipsis">
      Method Overview
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Method Overview">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-one-dsm" class="md-nav__link">
    <span class="md-ellipsis">
      Using One DSM
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-multiple-dsms" class="md-nav__link">
    <span class="md-ellipsis">
      Using Multiple DSMs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mission-to-saturn" class="md-nav__link">
    <span class="md-ellipsis">
      Mission to Saturn
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Mission to Saturn">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#set-up" class="md-nav__link">
    <span class="md-ellipsis">
      Set-up
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bounds-and-constraints" class="md-nav__link">
    <span class="md-ellipsis">
      Bounds and constraints
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#optimisation" class="md-nav__link">
    <span class="md-ellipsis">
      Optimisation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>Trajectories with Deep-Space Manoeuvres</h1>

<p>This tutorial shows how to refine trajectory solutions generated by <strong>ASTRA</strong> using multiple <strong>Deep Space Manoeuvres (DSMs)</strong>. These impulsive manoeuvres are assumed to occur between consecutive planetary encounters. It is also possible to include more than one manoeuvre in each leg of a <strong>Multiple Gravity Assist (MGA)</strong> mission.</p>
<p>For further background on this topic, you may refer to <a href="#1">[1]</a> and <a href="#2">[2]</a>.</p>
<p>In order to run this tutorial, the <a href="https://it.mathworks.com/products/parallel-computing.html" target="_blank">MATLAB Parallel Computing Toolbox</a> is needed.</p>
<h2 id="method-overview">Method Overview</h2>
<p>The main model used to refine ASTRA solutions is the <strong>MGA-nDSM</strong> model, where one or more manoeuvres are placed between consecutive planetary encounters.</p>
<p>The following sections provide more detail.</p>
<h3 id="using-one-dsm">Using One DSM</h3>
<p>After each planetary encounter, the trajectory is propagated forward to the time of the manoeuvre. From that point, a <strong>Lambert problem</strong> is solved to reach the next encounter. The DSM is then computed as the difference between the final velocity from propagation and the initial velocity provided by the Lambert solution.</p>
<p>It is also possible to specify whether a DSM should be included in the <strong>first leg</strong>.<br />
- If <em>not</em>, a Lambert arc is solved directly between the departure body and the first planetary encounter.<br />
- If <em>yes</em>, the initial position is taken from the object's ephemerides (see also the <a href="../nasa_ephemerides/">ephemerides tutorial</a>), while the initial velocity is defined by:</p>
<ul>
<li>infinity velocity magnitude  </li>
<li>declination  </li>
<li>right ascension  </li>
</ul>
<p>At the next encounter, the Lambert solution yields the arrival velocity, from which the incoming hyperbolic excess velocity can be derived. The fly-by parameters are then optimised:</p>
<ul>
<li>periapsis radius of the flyby hyperbola  </li>
<li>inclination of the flyby plane  </li>
</ul>
<p>From these, the outgoing hyperbolic excess velocity and the post-flyby spacecraft velocity are obtained, and the process is repeated.</p>
<h3 id="using-multiple-dsms">Using Multiple DSMs</h3>
<p>When using multiple DSMs per leg, the principle is similar. After each planetary encounter:</p>
<ol>
<li>The trajectory is propagated to the first manoeuvre point.  </li>
<li>A DSM is applied, defined by its components: <code>[DSMx, DSMy, DSMz]</code></li>
<li>The trajectory is then propagated to the next manoeuvre point, and so on.</li>
</ol>
<p>If the final DSM point in the leg has been reached, a Lambert problem is solved to reach the next object. As before, the final DSM is computed as the difference between the velocity after propagation and the initial velocity from the Lambert arc.</p>
<h2 id="mission-to-saturn">Mission to Saturn</h2>
<p>Let's have a look at a mission to Saturn similar to Cassini mission. This uses an MGA trajectory that is Earth-Venus-Venus-Earth-Jupiter-Saturn, using one main DSM in the Venus-Venus leg <a href="#3">[3]</a>.</p>
<h3 id="set-up">Set-up</h3>
<p>Assume you just launched an ASTRA run as from the tutorial on <a href="../trips_to_jupiter/">trajectories to Jupiter</a>. Now, one can extract the Pareto front as from:</p>
<pre><code class="language-matlab">% --&gt; process the OUTPUT
processed_OUTPUT = postProcessOutputASTRA( OUTPUT );

% --&gt; process the output for better user experience
paretoFront = process_paretoFront_structure( INPUT, processed_OUTPUT );
</code></pre>
<p>From the structure <code>paretoFront</code> one selects the preferred solutions based on user-defined objectives (e.g., launch date, departing infinity velocity, arrival infinity velocity,...). Say that you want the <code>n_sol</code> solution:</p>
<pre><code class="language-matlab">path = paretoFront(n_sol).path;  % --&gt; this encodes the trajectory
revs = paretoFront(n_sol).revs;  % --&gt; this encodes the revolutions for the Lambert solver
res  = paretoFront(n_sol).res;   % --&gt; this encodes the resonance (empty if no resonances are present)
</code></pre>
<p>Let's also specify the ephemerides and central body used to obtain such solution:</p>
<pre><code>INPUT.customEphemerides = @EphSS_cartesian; % --&gt; ephemerides used
INPUT.idcentral         = idcentral;        % --&gt; central body (Sun in this case)
</code></pre>
<h3 id="bounds-and-constraints">Bounds and constraints</h3>
<p>First, one needs to specify how many manoeuvres are needed for each planet-to-planet leg. A function is present that assumes 1 manoeuvre per leg for each revolution in the leg (so if the spacecraft does 2 revolutions in one leg, then 2 manoeuvres are added):</p>
<pre><code class="language-matlab">% --&gt; number of DSM w.r.t. the number of revolutions per leg
[NmanLeg] = revs2NmanLeg(revs);
</code></pre>
<p>Now one needs to specify the bounds for the optimisation problem. One defines these with respect to the ASTRA solution contained in <code>path</code>:</p>
<pre><code class="language-matlab">t0days      = 35;      % --&gt; days plus/minus the reference launch epoch from the path
tofperc     = 10/100;  % --&gt; percentage plus/minus the reference time of flights from the path
rpperc      = 90/100;  % --&gt; percentage plus/minus the reference periapsis altitude from the path
ksperc      = 90/100;  % --&gt; percentage plus/minus the reference flyby plane inclination from the path
</code></pre>
<p>The variables are the following:</p>
<ul>
<li><code>t0days</code>: Time window (in days) allowed around the reference launch epoch.</li>
<li><code>tofperc</code>: Percentage variation permitted in the time of flight for each leg.</li>
<li><code>rpperc</code>: Percentage variation allowed in the periapsis altitude during flybys.</li>
<li><code>ksperc</code>: Percentage variation allowed in the inclination of the flyby plane.</li>
</ul>
<p>Then, one specifies if a DSM is needed on the first leg. If <em>yes</em>, then the maximum and minimum infinity velocity should be specified, otherwise those values are ignored</p>
<pre><code class="language-matlab">optFirstMan = 0;       % --&gt; flag to check if the first leg has a manoeuvre (0 is okay for most of the cases)
vinfMin     = 0;       % --&gt; minimum v-infinity at departure [km/s] -- only works for optFirstMan = 1;
vinfMax     = 4.0;     % --&gt; maximum v-infinity at departure [km/s] -- only works for optFirstMan = 1;
</code></pre>
<p>Finally, one needs to specify the maximum and minimum values for the <code>[DSMx, DSMy, DSMz]</code>, <em>if multiple manoeuvres are present in any of the legs</em>. Otherwise, this will be ignored by the optimiser.</p>
<pre><code class="language-matlab">dvsMaxMag   = 0.5;     % --&gt; maximum DSM magnitude [km/s] -- only works if more than one manoeuvre is present in the leg
</code></pre>
<p>One can assemble the full problem by building the lower and upper bounds, as well as passing in a structure the number of revolutions and DSMs per leg (<em>this behaviour might change in the future...</em>):</p>
<pre><code class="language-matlab">% --&gt; build the lower/upper bounds based on previous options
[ t0Min, t0Max, TOFMin, TOFMax, rpMin, rpMax, etaMin, etaMax, seq, path ] = ...
            minMaxFromPath(path, t0days, tofperc, rpperc, ksperc);
[epsMin, epsMax] = minMaxEps(NmanLeg);                                          % --&gt; min. and max. fraction of time in the leg at which the manoeuvre is applied (between 0 and 1)
[dvsMin, dvsMax] = minMaxDVS(dvsMaxMag, NmanLeg);                               % --&gt; min. and max. DSM components -- only works if multiple manoeuvres are present in one leg
[dv1Min, dv1Max] = minMaxFirstMan(vinfMin, vinfMax, optFirstMan, NmanLeg);      % --&gt; min. and max. initial infinity velocity -- only works only works for optFirstMan = 1;
lb               = [ t0Min TOFMin dv1Min dvsMin epsMin etaMin rpMin ];
ub               = [ t0Max TOFMax dv1Max dvsMax epsMax etaMax rpMax ];

struc_revs_man.revs       = revs;       % --&gt; revolutions per leg
struc_revs_man.NmanLeg    = NmanLeg;    % --&gt; number of manoeuvres per leg
</code></pre>
<p>Finally, the cost function is specified, that takes into account the first delta-v (or infinity velocity if leaving a planet), plus the sum of all DSMs that are present in the trajectory, plus the final delta-v (or final infinity velocity if arriving at a planet):</p>
<pre><code class="language-matlab">% --&gt; define the cost function
costFun                = @(x) wrap_mga_nDSM(seq, x, struc_revs_man, INPUT.customEphemerides);
</code></pre>
<h3 id="optimisation">Optimisation</h3>
<p>One can now launch the optimisation. <a href="https://it.mathworks.com/help/gads/particleswarm.html" target="_blank">MATLAB Particle Swarm Optimisation (PSO)</a> is used.</p>
<p>First, let's define some options for the PSO:</p>
<pre><code class="language-matlab">% --&gt; options for the PSO
maxit       = 2;                           % --&gt; max. iteration for the PSO
useParallel = true;                        % --&gt; use parallel computing for the PSO (suggested: true)
optionsPSO  = optPSO(lb, ub, useParallel); % --&gt; build the options for the PSO
</code></pre>
<p>One specifies 2 iterations for the PSO running, as this is a meta-heuristic algorithm that is not deterministic so in order to increase the chances to find good solutions multiple run might be needed.</p>
<p>Finally, one can run the PSO for the number of times selected, and the minimum solution is retrieved:</p>
<pre><code class="language-matlab">% --&gt; optimise
sol        = zeros(maxit, length(lb));
fval       = zeros(maxit, 1);
for ind = 1:maxit
    [sol(ind,:), fval(ind,:)] = particleswarm(costFun, length(lb), lb, ub, optionsPSO);
end

% --&gt; extract the minimum solution
[minc, row] = min(fval);
minsol      = sol(row,:);
</code></pre>
<p>To plot the optimised trajectory, one re-uses the function <code>wrap_mga_nDSM</code>:</p>
<pre><code class="language-matlab">% --&gt; plot
[DV, dv, t0, tofs, MAT, output] = wrap_mga_nDSM(seq, minsol, struc_revs_man, INPUT.customEphemerides, 1);
</code></pre>
<p>The final output should be something like the following trajectory. </p>
<p><img alt="cassini_traj" src="../img/cassini.png" /></p>
<p>As it can be seen, the PSO has found a DSM of about 0.4295 km/s on the Venus-Venus leg of the transfer. The initial infinity velocity at Earth is about 4.045 km/s and the final one at Saturn is 5.131 km/s. These values are compatible with the ones of the actual Cassini mission <a href="#3">[3]</a>.</p>
<h2 id="references">References</h2>
<p><a id="1">[1]</a> 
Vasile, Massimiliano, and Paolo De Pascale. "Preliminary design of multiple gravity-assist trajectories." Journal of Spacecraft and Rockets 43.4 (2006): 794-805.
<a href="https://doi.org/10.2514/1.17413" target="_blank">https://doi.org/10.2514/1.17413</a></p>
<p><a id="2">[2]</a> 
Bellome, A., “Trajectory design of multi-target missions via graph transcription and dynamic programming,” Ph.D. thesis, Cranfield University, 2023.
<a href="https://dspace.lib.cranfield.ac.uk/items/711f45c8-e6e4-4f27-909d-94170df400e3" target="_blank">https://dspace.lib.cranfield.ac.uk/items/711f45c8-e6e4-4f27-909d-94170df400e3</a></p>
<p><a id="3">[3]</a> 
F. Peralta and S. Flanagan, “Cassini interplanetary trajectory design,” Control Engineering
Practice, vol. 3, no. 11, pp. 1603–1610, 1995.
<a href="https://doi.org/10.1016/0967-0661(95)00171-P" target="_blank">https://doi.org/10.1016/0967-0661(95)00171-P</a></p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["content.code.copy"], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.c8b220af.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/contrib/auto-render.min.js"></script>
      
        <script src="../js/katex.js"></script>
      
    
  </body>
</html>